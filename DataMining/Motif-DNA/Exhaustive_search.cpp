#include <cstdlib>
#include <iostream>
#include <cstdio>
#include <fstream>
#include <string>
#include <vector>
#include <map>
#include <algorithm>
#include <ctime>
#include <random>

using namespace std;
string DNA[30]={
"CATGTCTCCAACCACAGTCTTTTGTTTCCTTACAAAAGGCAGATCCAATGTCCTCTTTGTTTAGCACCTGAAACAAAGCACCTGAAAAGCAGGTCCATAATTGGGATTTGGGGCACTGGACCCAGAAACAATACATCAGGGTAGTTCTTTATGGTGGAATTTTGCTAAAAGGTTCTGTTTCATCTTTATATGAGTATGGTAGACTAATTTGTGAGATAATATTTTGGCCGTAAGCACATTTTCTGCAAGTAAATAAGAAATCAGGTATTACACAAGTGAC",

"TTTGAAGCTACTGCTCTGTGTTCTCTTTGCTATCAGTTTTAATAACTGTTTTTAAGACACCATGTTTTGAAAAGAGCTTTGTTTTTCTCAGCTCTTTCTCTCATCTGCTACATTTTGTAAGAAAGCCATAATCTCATGTTTATGATATTAATTATTGTGGATGTTATGTTATGTTATCAATGCTGTACTGAGACAGTACGGGTCAATAAAAGGATTTGAAATATGAGTATTAAACTACAGTAAGCATTTTTAAAAAGTAAAACGTCTCATAAATAGAATC",

"AGTTTTAGAATTAATACATACTCACCTTTGTACTCACTTATTGTTTAGCTGTAGGTACATTTTAAAGAATTAGGCCAAAGCAAACTCTATTTGAAAACACCTATTATTTGGAAAATGAAATTATATACAAATGATAAGATTATTATATTTTAAAGTAACCTCCCTTGCATGTCTCAGCATAAAGTATTTTTTTATGAAAGTAATTGACCTCTCTTCCTCCTCAGAATACTAGATAAGTACCACAGGTTGTGGGGGTGTGTGTGTGTTTAATTAATATGAG",

"AGGAAAGACAGAGCCCTTTAATAGAAGACTCTTCTGCCTTAAATAATAATTTTCTTAAAGCCTTTTATTCCTGCCACTTGAATGAAAGGAAAGAATGCCTTTCTTTCTTATCATCTCCTTGCTTTCCTGGTTCCTCAATTACCAGCTCCCAGCTCCTACTTCTTCTGCCATAGCAGACTATATTGACATGGCTCCATTACCAGCAGACCACTCCCTCCCACAATGCACCACAGTGCTTTCAACCCACTGGATTTCCCACAGGTCAAATTAGAAAGGACTT",

"GGATCAGAGAAGGGCACTTCTCATGGGCCATAATGTGAATTTTGACTAATGGTAAATGAAGGATGAAACTAGTTTGAGAAGAAACATGTCAGACAAGTTTTCCTCAGATGGCAAGCTAATGTTTTTACAGCATTTTTTCCATCATTACAGTTCTCTCATTCCTGTTTTGATACCACCAACTTGACTTATTGCCTGATTCTTGTCCCTGGTTTTGCCTCTTTGTTGCTCTTTTTCACTCTGTCCTCTCAGTCATCAAAGGAGAGGGAAAAGCAGTCTATTT",

"ATTTGAGAGATTTCACCTAGATTATTCAGCAAATGCTTTCATTAGGCTGTATTTGTCAGTCCACTCTCTTATCTTATTTTCCTCAGTGAGCTCCTTGAAGTTCCCTCAGTGAGCTCCTTGAAGGAAACTCCTATTTTTCAACATATGACTGGCTGTAATTTTTCAACATTACAGGCTGGCACTTAGCATATCATCAGTGCTTAATAAATTTTTTTTTTTTGGTCATACAAACTTAATTAATAGGATGTGTAATGTGTCCTGGCCTCTGAAAAAACTGTGT",

"CATCATTGGGCTATTGTCAGCTGGGAGAAGTTGAGAAGTCCTATGGACTCTGAGGCAAAGGCACCTCCCACTTGCTTGGGAATGATGGGTTGGAGGTGGTGAAATTATCAGTGATCAAAGACATGTCTATTGCTTCCCATTTGCCCATCAAAAATAAGCCAAGGCCAGCAAGAATGAAGAGTTGCATGAGTCATCAGACGCTGGTGAAAATGATAGAATTTGAAGCTTCAAAGTAATCCATAAGCTTAATCAACAAAATACTAAATTTTGCTAGTGATAA",

"TGCTAAAATTTAGCTTTTTGCTATTATTATTAAGAAAAATAATAGTATTTTGAAATGAGGCACTTGATTGCACCTAGGTCTTTGTTTTCTTTGTAAGATTGCCTAAAACCTATCTGCTGCCTGTATTTAAAGGAGTAGTTACAACGTCCCTCCAGCCTCTCTGTAGGAGACAGAGACAGGAAATCTGCCCCAGGTCTGTGTGTGGGCTCCACAGACACTGCCAATACAGGAGTGCTGAACTCACAGCTGAGTCACATTGCTGTCCACACTACATAAATTA",

"TTTAAGACTTCAAAGGGAGAATATGATAGTGTAATGAATTTAAAATTCACAATGTACAACTGAAGTGAGAAGAAATGTATTTTAGTTTACTTCTCCATAGTGGAATTCAATTTAACTTTAAAGTTTCCATTTTCAACGACAGAGGTAAACTCAGCCTTGTCACTCTCAAGGTAACTGTGTCATTGCAGTTTCAAGGTTAGTCTCTTGGAGTAAATATTCAGTCAAATTAAAGATTTAAGCTCAGTAAGTTGGAGCTCAAATTCAATACATGAGCTGCAAT",

"CCACTCTCAAGGATTCTCGTCTTCTCTTTCCCCTCAGGATATATCTGTGTACAGGGGTTCGTCTGGCTGTGCCCCAGATGCTTGTGTCCTTGCTGCAGCTGAAGGTTTTACAGCTGGTAACTTGTAGCCTGTTGTCTAAATGTGATAAAGGCCCACTATGGCCACCCCCATTCAGCCCCTTCTGGCTCAAATGAAGCTTGGAGACTCAACCTCACATTGATCTTTTCGGCTTCCCACCCTAGAGCCTGGGCTATAGGTCACCATGCTCCAAGGTGAGATG",

"GCCCCTGTCATGCCTATTGCTGGACCTATTGGAAAGCTCAGTGTGCTTCCGCCATGTTCAGGCTGTGGGCACTGTGTCCAGCCTTCTCTCTACTTAACCTTCCATTTCTACTCAGTTTGGCAAGGAGCACGCTGTCGGGTGATTTCCTCCCAGGGTTCCAGAGAAGAGAGTCAAATGTTCCCCCTGCTCTAGGCTTTCCAAGTTCATCTAGGGGTATCTATCTCCTACAGCGAGGCTGCGGAAAGGTTGTAACTACTTCAAATACAGACAGCAGATAGGT",

"TTTAGTGCAATCTTACACAGAAAGCAAAGATCTAGGTGCAATCAAGTCTTTTATTTTAAAATACTACTCTTTTTCTTAATAACAGCAAAAAATCTAAATTTTGGCATTATTCCTGGCAAAATTTAGTATTTTCTTGATTGAGATTATAGATTACTTTGGAGCTTCAAATTCTGTCATTTTCATCAGCATCTGATGACTCATGCAATGCTTCGCTCTTACTGGCCTCAGCTTATTTTCAATGAACAAAAAGGCAGCAATAGAATCTCTTTGATCACTGATA",

"ATTTTATCACCTCTAAGCCATCATTCCCAAGCAAGTGGGAGGTGCTCCTGAAAGAAAGTTGTGACTGGGAACTAGGCCAGGACGCTTTGGAAATGGGGTGGTTGTAGGGGGATGGTAGGGCACATTGAGGCCAGAAAGATACTTTTTCCTCAACAGTGAATGAATTGGCTACATTGTCTGGAAGACCCTCAAGTGTCACCAGGAGCTGTGTTTCTTGAGAGCAGTGTCCTGAGGCAGCCAGCCTGAGTCAACTTGAAATTCTATGGAGACCTGGAAGTAT",

"CTTTGGTTTCCATGGCCAGAGGCACAGAACACCTGGAGCTTCCCCCTTCTCCACTTCCTGCCTCCTAATCCCCACCCCCTGTGCTGACAGTCTGCTTTACACTGGTTCACTACCACTGTCATGTTTGTAGTGTTCGGCATCATGAGACATGCCTGAAAGAGATTATTATGGCAAAGATAAGGACAGGCAGCAGACTACTACATGTGTAGTTCCAAAGTGAAATCATCAACCTCCATCTGACTGACCAAGTTCGTTACATACAAGGAGAACTAGAGTGGTT",

"GCCTACCTCTAACCAGACACAGAAGACTTTGGTCTGCAGATGGCAACAGAGTCCACACCAGAATCCAACTTCCACCCAAAGCCTGGGCAACATCTAGTGATGCTGCTGCTGCTCTCCTGGTTTTAGCAGGAGGATTTTCTTTGTTGTCCCCAGTCCCATGACACAGCTCCCCTGTGTCTTGGAGCAGGGGTCTCCTGCAGTGTGTACCCCACAATGGGGCTTGGAGCTTAAAAAGTCCCCATCTCCAGGCAGATTGACTTCAGATGAGAATGAGAAGGAA",

"GCCTAAACATTTCAGGCATGAGATGCTGTGCCAATTATCAATTTATTACCTGTCCATTCTGAACTCACCCTTCACTGCCTGCTCTGCAATAATGGAGTTAGACTCAGTATTTCTCTTCTGCTAGTTAGCATGATGTTCGTCGGTAGAGGGTGCTAGAAGGTCACTGGAGGAAGAAGGGATTTCTTGTCCTTTTCTGGTGTGCACCTCTCAGCAAGCTCCTACAGTACCCACTGGCTTACACAGCATCAGCTCCTCCAGTGCACAGGGGATAGCAGTGTCC",

"AGCAGCCAGCAGTAAGTGCTACCTCCCCAGGGGCATCGTTCCCTATCACCTTCTCAGGCTGCTTTGCAATGGAGTACCCTAAGCTCAGCACTTCCCCAGAAATGTCTCCCCAAAAATCCTCTCACAGAGCTTTGCAATGAGATCCAAGGCATGGCACCTCCCCATGGGGAGCTTCCCCTGGTAATCTAGAGGGTGGATTCCCAGGTAGTCCCACCAGCAGAGGACCTCAGCAAACCTCTTCTCCATCCAGTGAGCCATGGTTGCACCCTCTACCAATGAG",

"GTCTGGATCTGGATCTCAGCCCAGGATGGAGGAGTCTCTTCCTTGGATGCTCTAGCTCAGCCCTGAGTTGTAGCTGCTCTCCATTAGGTTGCTTTCGGCCTTAAAGTTATTTTTACCTTTGACTAGCTAATCTCCTCTTACTCTAATCTTTTGTTAAAGTTAATAGTTCTCTATTTCAATTTCTGATGTTCAAATTACTATGTGGTGTCTGTCTTCTGATTGAACTCCGAACTAACACCAATGCCAAAATGCAAACATACACAGCTACACCTGCTCCTAA",

"GCCCCCTGAAGATAAACACACACACACACACACACTTTGAAATAGGGCAGAAGAGACTTAGGAGACTCATGTGAGCTCAGCTTTACTAACAAAAGATATTTTCCAAAAGGAAGTGAAAAGCACCTAAGAAGGCAGAGTGAAACTTAGACCACACACACACACACACACACACACAAAAAAAAAAAGAAACTGCCCAGCCCTCTTCAGGAACATAGAGATAGGCACTAAGTTGCCATCCATGGAGACATAAATGAAGAGCTACTCACTCACTGCTTTGCAC",

"TTTATAAGGATGTTGGAAGGTCTTCAAGTCAGAGGGCAGAAATAAAGCCCAGGACTCACCAGTGAGCCCTCAAAATATGAGTTCTATTCTACTGATGGGGAATATTGGTTAGCCCCTTAATCCTGAATCCAGTTCTGCCTCATTAGACAAGGAGGAAACCCCGGGTCCCTGGTGTCTAGGACCCCAGACTACCATCACCCTGCTGCCAATAGTGCTTCACCCAACTCCCACTGCCCACTCTCTTGACCCACAAGGCATACCTGGGAGTTGACCCAACCCT",

"TTTATCAATCCGGCCTTCCCATTTTTCTTTGGCACCATCCCTGTGCTTTGGGTTTTAGGGGTTTTAGTGCCTTCCTTTCCTCTTTTCTCTTATCTCATCCTCCTTGATGGGGGGACTGGAAGAGGCACAATACAATTTCTAAATATATTTGTTTTAAAAAAACACTATAAATAATTATGAGGTAGAAATCATAAAAGCATGGGTTCAAAATGAATAAAAATGCCAACTCCCATAATGTTATGTAAATAGGTACTTGTAGCTTATGATAAAATTGCTGAAG",

"ACAGCTTCTTGCTGGGATTCAAAAAGTGCTGTATTTCAAATAACAGATCGAATGAAACAAAGCTGATGTGCTTGGAAAAAACCGGGGTAAGATGACACCAGCGTGGTTCTAGTGTTGGCAAAGATTATAATGCTGAAGATACATGCAAGGAACTTAAGTAAAACTAGGTCATAATATGTGAGACAGAAAAACTCTAGAACATTCTTAAATGCACATGTCATTTTATATGATATGGGATTTTAATAAATAATAGTTAATTATAACAAAGTTTTTAGAAACA",

"GACATTTGACTGTTTTGACTATATCCTTAGAAGTGTGTATTGTTTCCAAGTTGGCCTATCATTTTTTAGTCGCTTTTTTGGAAAAAAAAAAAAAAGGAAGGTCTCCTCATATTCAGGATTGCCTAGTGTTCAGGCACATGAGGACTACCATGAGCCTGGTAGCTAGTAGTCAGACAATAACCTGTCTCTTTCAGTTCAAGGTAAAGCAAGCCTATGCTTGAGCCTCCCTCAAAGCTTCCTGCTTTAGGAATTTACTCATCTCTCAGAACTGGTGAGAACA",

"GTGTCTGGCTCTCTGAGATACTAGCTTTCCTCCCTAGAAAAGTAGTTGGTAGCCCCTAGCATTGAAGTCTCTTTTAAAAATTCGAACACAACCCATATACATACATACGGTTAATTGGCTTTCAACAAAGGTGCAAAATCAACTCAATGGAGAAAGAAGATTCTTAAATGATAATCACAAATGATTATGGAACAATTGGACATCTATATACTAAAAAAGAGAGAACCTTAGCCCTTATCTTGTACCACACACAAAAATTAAGGTAAAAATAGATCATTAA",

"CCTAAATGTACAACATGTAACATGTCTAGAAAAAGTCACAGGAGAAAAATTTTGTGACCTTGGGTTAGGCAAAGATTCATTAGATACAACACCTATAACATGATCCACAAAAGAAATAAAAGCTGATAACCTGGACTTCATTAAAACTTAAAACTTCTACTCTTGAAAAGACACTGTTAAAAATATAAGCTACAGACTGTGAGAAAATATTTATAAAATACATATTCATTAAAAGACATATTTCCAAAATACATAAAGAGCTCTCTCAACTCAGTAGGTT",

"TTTAAAATCCCATTTAGAAATAGGCAAAAATTTGAACAGACACTTCAACAAATTAAATACATAGATGGCAAATAAGTACATGAAAAGATGCTCATCATTTAAGATATGTGATTGGCAGTTTCTTATAAAGTTAAATATACACTTACCGTATGACCCAAAAATCCCATTCCAAGGTATTTACTCAAGAGAAATGAAGACATATACCCACTCAAAAAACTGTACACAAATATTTATAATGGATTTATTAATAATCACCCCAAACTGAAAACACCCAAATATT",

"TTTCAACCAGTGAATGGGTAACAAACAATCGTACATCCGTATAATGCAGTAAATAGACAGGAAATACTAAACATGCAACAACACGGGGGAATCTCCAATACATTATGCTAAGTGAAAGAAGCTGGACTCATAAGGTATAGGACAGTCTGCAAAAAAACAAAATAAGAGGGATAGAGAAGTAATCAGTGGTTGCCAGCAGCTGGAAATGGGGAGGGGTTGACCACGAATAGGCTCAAGTGAACATTTGGGTATGACAAAAAAGTTCTATATCTTGATTGTG",

"GTGGTGGTTACATGACTGTCTGCATTTGTCAAAGCTTATTAAACTATACTTTTAAATGGTGAATTTTGCTGTGTATAAATTACAGCTCAATTTAAAAAAACAAAAACAAAAACAAAAAACTCTGACCCAGATCACTGTGGTCATTGTTGGTGGAGACTGCTGGCCTCTTAGCTCTCTTATGAGTGGGGTTACCAGCTAATCCCTGACATATTTGTGGTTCCAGGACTCCTAAAGGGTTGTGCAATGGTTTGTCTCCTTTCTCAAAGACAGCTGCTGGCTG",

"ATGGTAAAAGATAAAGAGAAAGAAAGATGTACACAGGCAAGTCAGGGAGAAATTTATCTTTCTTTTCCTTCCTGTCTTTCTTTTATATTCTTCCTCCCTCTTCTATTTCCTGCAGCCCTTATTTTTCTTTCACTTACTTTTCCTATTTATTCATCAGCTGAAACCTTGCTGAAAGGGATTAGCTGGGGGCTAAGTCGAGTAGGGCAAAAGGAAGCATTTGCTTCTAATCAGTAGTACACTGGTAAATGATTAGTAACCAGCTCTCTGAAACACCCACACA",

"CACACACAAACACACACACACACAAACACACACACACACAAACTAAAGTTTCTTTTAAATTTTACTGATATGAAGAGTATATAGCACAGGCTGGGTGCAGTGGCTCACGCCTATAATTCCCAGCAATTTGAGAGGCTGAGGCAGGTAGATCACTTGAAGTCAGGAGTTCAAGACCAGCCAAGGCAACATGGCAAAACCCCATCTCTAATAAAAAAAAAAAAATACAAAAATTAACTGGGCATGGTGGCACACGCCTGTAATCCCAGCTACTCAGGAGGCT",

};
int main()
{
	default_random_engine random_engine;
	clock_t t;
	float score;
	map<char,vector<float>> map;
	std::vector<float> len(280,0);
	map['A']=len;
	map['T']=len;
	map['G']=len;
	map['C']=len;
	//统计ATGC频数
	for(int i=0;i<30;i++){
		for (int j = 0; j < DNA[i].length(); ++j)
		{
			map[DNA[i][j]][j]++;
		}
	}

	//---------------------Exhaustive search 计算consensus------------------START
	t = clock();	
	string consensus;
	std::vector<float> sonsensus_count;
	
	for(int i=0;i<DNA[0].length();i++){

		//从map里得到每个位置出现次数最多的核苷酸
		char char_max;float int_max=0;		
		for (auto j = map.begin(); j != map.end(); ++j)
		{
			if(j->second[i] >= int_max){
				char_max = j->first;
				int_max = j->second[i];
			}
		}
		sonsensus_count.push_back(int_max);
		consensus.push_back(char_max);
	}
	
	float max_score=0;
	std::vector<float>::iterator start_position;
	for (std::vector<float>::iterator i = sonsensus_count.begin(); i != sonsensus_count.end(); ++i)
	{
		score = accumulate(i,i+30,0.0);
		if(max_score < score)
		{
			max_score = score;
			start_position = i;
		}
	}

	//计时结束
	t = clock() - t;
	float f = ((float)t)/CLOCKS_PER_SEC;
	cout<<"max score:"<<max_score<<" motif:"<<consensus.substr(start_position-sonsensus_count.begin(),30)<<endl;
	for (std::vector<float>::iterator i = start_position; i != start_position+30; ++i)
	{
		cout<<*i<<" ";
	}
	cout<<endl;
	printf ("totally %f seconds.\n",((float)t)/CLOCKS_PER_SEC);
	//---------------------Exhaustive search 计算consensus------------------END



	return 0;
}